Memory-safe sprintf, pre-2005 by Morgan McGuire
